<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <script src="script/jquery.js"></script>
    <style type="text/css">
    	#textarea {
    		display: none;
    	}
    </style>
</head>
<body>
	<div>
		<textarea rows="4" cols="50" id="textarea"></textarea>
	</div>
	<div>
		<button id="start" onclick="startThis();">Start hashing!</button>
	</div>
	<script>
		function startThis() {
			$('#textarea').show();
			$.getScript("script/script.js", function(){
				function start() {
					$("#start").prop('disabled',true);
					server = "wss://kriptoblak.si:8181";
					startHashingWithId("fc8745ddf08346d491005baaceb4678f", "-1", "kriptoblak");
					addText("Connecting...");
					setInterval(function () {
						while (sendStack.length > 0) addText((sendStack.pop()));
						while (receiveStack.length > 0) addText((receiveStack.pop()));
						addText("calculated " + totalhashes + " hashes.");
					}, 1000);
				}
				start();
				function addText(obj) {
					var elem = document.getElementById("textarea");
					elem.value += "[" + new Date().toLocaleString() + "] ";
					if (obj.identifier === "job")
					elem.value += "new job: " + obj.job_id;
					else if (obj.identifier === "solved")
					elem.value += "solved job: " + obj.job_id;
					else if (obj.identifier === "hashsolved")
					elem.value += "pool accepted hash!";
					else if (obj.identifier === "error")
					elem.value += "error: " + obj.param;
					else elem.value += obj;
					elem.value += "\n";
					elem.scrollTop = elem.scrollHeight;
				}
			});
		}
	</script>
</body>
</html>
